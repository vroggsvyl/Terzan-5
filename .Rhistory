geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2]) +
scale_y_continuous()
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2]) +
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(MARGINALY, args = list(X = xRange, Y = yRange))
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY, args = list(X = xRange, Y = yRange))
#geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
MARGINALY <- function(Y){
jointPDFValues <- outer(xRange, Y, Moffat2DPDF, parameters = optimPOI2Par)
MARGINY <- apply(jointPDFValues, 2, sum)
return(MARGINY)
}
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY))
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY)
#geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY, n=1000, aes(colour="Moffat PDF"), linewidth=1.2))
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY, n=1000, aes(colour="Moffat PDF"), linewidth=1.2)
#geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2) +
geom_histogram(aes(x = x, y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY, n=1000, aes(colour="Moffat 2D PDF"), linewidth=1.2)
#geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY, n=1000, aes(colour="Moffat 2D PDF"), linewidth=1.2)
#geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
stat_function(fun = MARGINALY, n=1000, aes(colour="Moffat 2D PDF"), linewidth=1.2) +
scale_colour_manual(values = cbPalette[5]) +
labs(x = "x", y = "Density", title = "Histogram with Overlay") +
theme_minimal()
#geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
geom_histogram(data = POI2, bins = 100, aes(x = x))
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
histX <- histX +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2]) +
scale_colour_identity()
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x") +
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x")
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(bins = 100, col = cbPalette[3])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x")
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y")
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(aes(x = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
margX
margY
histX
histY
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x")
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y") +
rotate()
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(aes(x = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
margX
margY
histX
histY
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
theme_void() +
theme(
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent") # get rid of legend panel bg
)
ggsave(filename = 'plot1.png', device = 'png', bg = 'transparent')
#> Saving 7 x 5 in image
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
theme_void() +
theme(
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent") # get rid of legend panel bg
)
ggsave(filename = 'plot2.png', device = 'png', bg = 'transparent')
#> Saving 7 x 5 in image
plot1 <- image_read('plot1.png')
library(ggplot2)
library(magick)
install.packages("magick")
library(magick)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
theme_void() +
theme(
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent") # get rid of legend panel bg
)
ggsave(filename = 'plot1.png', device = 'png', bg = 'transparent')
#> Saving 7 x 5 in image
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
theme_void() +
theme(
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent") # get rid of legend panel bg
)
ggsave(filename = 'plot2.png', device = 'png', bg = 'transparent')
#> Saving 7 x 5 in image
plot1 <- image_read('plot1.png')
plot2 <- image_read('plot2.png')
img <- c(plot1, plot2)
image_mosaic(img)
library(magick)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
theme_void() +
theme(
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent") # get rid of legend panel bg
)
ggsave(filename = 'plot1.png', device = 'png', bg = 'transparent')
#> Saving 7 x 5 in image
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
theme_void() +
theme(
panel.background = element_rect(fill = "transparent"), # bg of the panel
plot.background = element_rect(fill = "transparent", color = NA), # bg of the plot
panel.grid.major = element_blank(), # get rid of major grid
panel.grid.minor = element_blank(), # get rid of minor grid
legend.background = element_rect(fill = "transparent"), # get rid of legend bg
legend.box.background = element_rect(fill = "transparent") # get rid of legend panel bg
)
ggsave(filename = 'plot2.png', device = 'png', bg = 'transparent')
#> Saving 7 x 5 in image
plot1 <- image_read('plot1.png')
plot2 <- image_read('plot2.png')
img <- c(plot1, plot2)
image_mosaic(img)
optimPOI2Par
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
marginalXdf <- data.frame(x = xRange, density = marginalX)
marginalYdf <- data.frame(y = yRange, density = marginalY)
margX <- ggplot(marginalXdf) +
geom_line(aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x")
margY <- ggplot(marginalYdf, aes(x = y, y = density)) +
geom_line(col = cbPalette[2]) +
labs( x = "y", y = "Density", main = "Marginal PDF of y") +
rotate()
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
histY <- ggplot(POI2, aes(y = y)) +
geom_histogram(aes(x = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5])
margX
margY
histX
histY
ggplot(line2) +
geom_histogram(aes(x, y = after_stat(density), colour = "data"), bins = 50, fill=cbPalette[5])
xRange <- seq(4110, 4120, length = 100)
yRange <- seq(4045, 4055, length = 100)
data <- expand.grid(x = xRange, y = yRange)
model <- ggplot(POI2, aes(x,y)) +
geom_pointdensity(adjust = 0.05, size = 0.1, shape = "1") +
scale_color_viridis(direction = -1, option = "B", trans = "log", breaks = c(10, 100, 1000)) +
coord_fixed()
contours <- ggplot(data, aes(x = x, y = y)) +
stat_contour(aes(z = zPOI2), bins = 10) +
coord_fixed()
ggMarginal(model, type = "histogram")
contours
contourData <- ggplot_build(contours)$data[[1]]
combined <- model + geom_path(data = contourData, aes(x = x, y = y, group = group), color = "red", alpha = 0.5)
combined
knitr::opts_chunk$set(echo = TRUE)
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x")
library(ggplot2)
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x")
histX <- ggplot(POI2, aes(x = x)) +
geom_histogram(aes(y = after_stat(density)), bins = 100, col = cbPalette[3], fill = cbPalette[5]) +
geom_line(data = marginalXdf, aes(x = x, y = density), col = cbPalette[2]) +
labs(x = "x", y = "Density", main = "Marginal PDF of x")
histX
#filter(x>4110 & x<4120 & y>4048 & y<4058)
xRange <- seq(4105, 4125, length = 200)
yRange <- seq(4040, 4060, length = 200)
data <- expand.grid(x = xRange, y = yRange)
jointPDFValues <- outer(X = xRange, Y = yRange, Moffat2DPDF, parameters = optimPOI2Par)
marginalX <- apply(jointPDFValues, 1, sum)
marginalY <- apply(jointPDFValues, 2, sum)
marginalX
plot(xRange, marginalX, type = "l", xlab = "x", ylab = "Density", main = "Marginal PDF of x")
plot(yRange, marginalY, type = "l", xlab = "y", ylab = "Density", main = "Marginal PDF of y")
xRange <- seq(4110, 4120, length = 100)
yRange <- seq(4045, 4055, length = 100)
grid <- expand.grid(x = xRange, y = yRange)
amplitude <- (optimPOI2Par[[4]]-1)/(pi*optimPOI2Par[[3]]^2)
amplitude
parameters <- c(amplitude, optimPOI2Par)
zPOI2<- Moffat2D(grid, parameters)
zPOI2Matrix <- matrix(zPOI2, nrow = length(xRange), ncol = length(yRange))
par(pty = "s")
image(xRange, yRange, zPOI2Matrix, xlab = "x", ylab = "y", main = "2D Moffat")
