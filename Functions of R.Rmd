---
title: "Exploring R"
output: html_document
date: "2023-11-01"
---

```{r}
set.seed(0)
g1 <- rgamma(1000, shape = 2, rate = 1)

set.seed(1)
g2 <- rgamma(1000, shape = 10, rate = 1)

set.seed(2)
g3 <- rgamma(1000, shape = 2, rate = 10)

set.seed(3)
g4 <- rgamma(1000, shape = 10, rate = 10)

par(mfrow = c(2,2))
hist(g1)
hist(g2)
hist(g3)
hist(g4)
```

```{r}
(function(x, y){ z <- x^2 + y^2; x+y+z })(0:7, 1)
norm <- function(x) sqrt(x%*%x)
norm(1:4)

```


```{r}
#Generate Random Data
set.seed(6)
dat <- rnorm(1000)
```


```{r}
#Moffat 1D
#One Dimensional Moffat Model

#Model Formula
#f(x) = A(1+(x-mu)^2/gamma^2)^-alpha

#Parameters
#A = Amplitude
#mu = the x position of the maximum of the model 
#gamma = core width of the model
#alpha = power index

#Defaults
#Amplitude = 1
#mu = 0
#gamma = 1
#alpha = 1

dMoffat1D <- function(x, amplitude, mu, gamma, alpha){amplitude*(1+((x-mu)/gamma)^2)^-alpha}

Moffat1D_Deriv <- function(x, amplitude, mu, gamma, alpha){
  chain = (1 + (x - mu)^2 / gamma^2)
  d_A = chain^(-alpha)
  d_mu = 2*amplitude*alpha*(x - mu)*d_A/(chain*gamma^2)
  d_gamma = 2*amplitude*alpha*((x - mu)^2)*d_A/(chain*gamma^3)
  d_alpha = -amplitude*d_A*log(chain)
  
  return(d_A, d_mu, d_gamma, d_alpha)
}
  #@staticmethod
    #def fit_deriv(x, amplitude, x_0, gamma, alpha):
        #"""One dimensional Moffat model derivative with respect to parameters"""

        #fac = (1 + (x - x_0) ** 2 / gamma ** 2)
        #d_A = fac ** (-alpha)
        #d_x_0 = (2 * amplitude * alpha * (x - x_0) * d_A / (fac * gamma ** 2))
        #d_gamma = (2 * amplitude * alpha * (x - x_0) ** 2 * d_A /
        #           (fac * gamma ** 3))
        #d_alpha = -amplitude * d_A * np.log(fac)
        #return [d_A, d_x_0, d_gamma, d_alpha]

```

```{r}
plot(dat)
hist(dat)
```
```{r}
Moffat1D_Deriv(2, 1, 0, 1, 1)
```

```{r}
set.seed(8)

data <- rgamma(1000, 4, 1)
plot(data)
hist(data)
beta = 2
alpha = 4

Gamma <- function(x){
  ((beta^alpha)/factorial(alpha-1))* x^(alpha-1)* exp(-beta*x)}
plot(Gamma, 0, 25)

optim(c(1), Gamma, method = "L-BFGS-B", lower = 0)
```
```{r}
#optim example code
## "wild" function , global minimum at about -15.81515
fw <- function (x)
    10*sin(0.3*x)*sin(1.3*x^2) + 0.00001*x^4 + 0.2*x+80
plot(fw, -50, 50, n = 1000, main = "optim() minimising 'wild function'")

res <- optim(50, fw, method = "SANN",
             control = list(maxit = 20000, temp = 20, parscale = 20))
res
```

```{r}
2^2
```

