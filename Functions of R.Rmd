---
title: "Exploring R"
output:
  word_document: default
  html_document: default
date: '2023-11-01'
---

```{r}
library(ggplot2)
library(plotly)
library(readr)
library(ggpointdensity)
library(viridis)
library(tidyr)
library(fitdistrplus)
library(rlang)
```

```{r}
set.seed(0)
g1 <- rgamma(1000, shape = 2, rate = 1)

set.seed(1)
g2 <- rgamma(1000, shape = 10, rate = 1)

set.seed(2)
g3 <- rgamma(1000, shape = 2, rate = 10)

set.seed(3)
g4 <- rgamma(1000, shape = 10, rate = 10)

par(mfrow = c(2,2))
hist(g1)
hist(g2)
hist(g3)
hist(g4)
```

```{r}
(function(x, y){ z <- x^2 + y^2; x+y+z })(0:7, 1)
norm <- function(x) sqrt(x%*%x)
norm(1:4)

```


```{r}
#Generate Random Data
set.seed(6)
dat <- rnorm(1000)
```


```{r}
#Moffat 1D
#One Dimensional Moffat Model

#Model Formula
#f(x) = A(1+(x-mu)^2/gamma^2)^-alpha

#Parameters
#A = Amplitude
#mu = the x position of the maximum of the model 
#gamma = core width of the model
#alpha = power index

#Defaults
#Amplitude = 1
#mu = 0
#gamma = 1
#alpha = 1

dMoffat1D <- function(x, amplitude, mu, gamma, alpha){amplitude*(1+((x-mu)/gamma)^2)^-alpha}

Moffat1D_Deriv <- function(x, amplitude, mu, gamma, alpha){
  chain = (1 + (x - mu)^2 / gamma^2)
  d_A = chain^(-alpha)
  d_mu = 2*amplitude*alpha*(x - mu)*d_A/(chain*gamma^2)
  d_gamma = 2*amplitude*alpha*((x - mu)^2)*d_A/(chain*gamma^3)
  d_alpha = -amplitude*d_A*log(chain)
  
  return(list(c(d_A, d_mu, d_gamma, d_alpha)))
}
```

```{r}
plot(dat)
hist(dat)
```
```{r}
dMoffat1D(2, 1, 0, 1, 1)
x <- c(-10:10)
plot(dMoffat1D(x, 1, 0, 1, 1), )
```
```{r}
Moffat1D_Deriv(0.5, 1, 0, 1, 1)
```

```{r}
set.seed(8)

randata <- rgamma(1000, 9, 2)
plot(randata)
hist(randata)
beta = 2
alpha = 9
```


```{r}
Gamma <- function(x, alpha, beta){
  ((beta^alpha)/factorial(alpha-1))* x^(alpha-1)* exp(-beta*x)
}

range <- seq(0,25, by=0.1)


plot(Gamma(range, 9, 2))
plotdist(randata, demp = TRUE)

#check
Gamma(5, 9, 2)
dgamma(5, 9, 2)

#res <- optim(c(5,9,2), Gamma)
```


```{r}
#optim example code
## "wild" function , global minimum at about -15.81515
fw <- function (x)
    10*sin(0.3*x)*sin(1.3*x^2) + 0.00001*x^4 + 0.2*x+80
plot(fw, -50, 50, n = 1000, main = "optim() minimising 'wild function'")

res <- optim(50, fw, method = "SANN",
             control = list(maxit = 20000, temp = 20, parscale = 20))
res
```

```{r}
range2 <- seq(-3, 3, by = 0.1)

par(mfrow = c(2,3))
plot(dMoffat1D(range2, 1, 0, 1, 1), main = "Default parameters")
plot(dMoffat1D(range2, 1, 0, 1, 2), main = "Changing alpha")
plot(dMoffat1D(range2, 1, 1, 1, 1), main = "Changing mu")
plot(dMoffat1D(range2, 1, 0, 0.5, 1), main = "Changing gamma")
plot(dMoffat1D(range2, 4, 0, 1, 1), main = "Changing A")
plot(dMoffat1D(range2, 4, 1, 4, 4), main = "Changing all")
```




